//#-p stonebrick 0 -b 9 19 -241 -print
///	C:\Users\Austin\Documents\Austin\powder game code\eGO\Events & Commands\Races\DeathR - Death Run\CBP_DeathRun.txt
//<Defines
DEFINE $CMDName$ DeathR
DEFINE $CMDSizeX$ 6
DEFINE $CMDSizeY$ 7
DEFINE $CMDSizeZ$ 10
DEFINE $Style$ 0 10 10
DEFINE $SA$ x=13,y=12,z=-260,dx=135,dy=50,dz=55
///	Name
DEFINE $Name$ Death
///	Text display name
DEFINE $TD$ DeathR
///	Hover and scoreboard name
DEFINE $TDName$ Death Run
///	Scoreboard teams color
DEFINE $Color$ red
///	Place where air is when open
DEFINE $Dao$ 41 17 -246 41 17 -237
///	Place where redstone blocks are there when open
DEFINE $Dro$ 
///	Spawn Coords for teleporting
DEFINE $SC$ 31 20 -240 -45 0
///	Spawn Coords ID
DEFINE $SPid$ 22
///	1st Place Select
DEFINE $Win1S$ x=26,y=19,z=-224,dx=1,dy=2,dz=2
///	1st Place Message
DEFINE $Win1M$ took first place!
///	1st Place Fill Coords
DEFINE $Win1F$ 28 16 -222 28 16 -224
///	1st Place Fill Block
DEFINE $Win1B$ redstone_block 0
///	1st Place Iron Bars
DEFINE $WinIron1B$ 28 20 -222 28 20 -224
///	2nd Place Select
DEFINE $Win2S$ x=27,y=19,z=-219,dy=2,dz=2
///	2nd Place Message
DEFINE $Win2M$ took second place!
///	2nd Place Fill Coords
DEFINE $Win2F$ 28 16 -217 28 16 -219
///	2nd Place Fill Block
DEFINE $Win2B$ redstone_block
///	2nd Place Iron Bars
DEFINE $WinIron2B$ 28 20 -217 28 20 -219
///	3rd Place Select
DEFINE $Win3S$ x=27,y=19,z=-229,dy=2,dz=2
///	3rd Place Message
DEFINE $Win3M$ took third place!
///	3rd Place Fill Coords
DEFINE $Win3F$ 28 16 -229 28 16 -227
///	3rd Place Fill Block
DEFINE $Win3B$ redstone_block 0
///	3rd Place Iron Bars
DEFINE $WinIron3B$ 28 20 -229 28 20 -227
///	Iron bar reset
DEFINE $IronBarReset$ 28 20 -229 28 20 -217
///	Other
DEFINE $RBlock$ 44 15 -246
DEFINE $ObsidianLoad$ 44 19 -246
DEFINE $FillStructure$ 44 17 -246 56 17 -237
DEFINE $Blindness$ x=42,y=19,z=-246,dx=23,dy=9,dz=9
DEFINE $Dispenser$ 80 20 -230
DEFINE $SP$ x=25,y=20,z=-247,dx=11,dy=5,dz=14
DEFINE $Checkpoint$ x=128,y=19,z=-229,dy=5,dz=12
DEFINE $CheckpointTP$ 127 19 -223 90 0
DEFINE CCItem_Potion potion 1 0 {HideFlags:127,Potion:"healing",CustomPotionEffects:[{Id:22b,Amplifier:0b,Duration:1800}]}
/// Races
DEFINE $s$ minecraft:
DEFINE $ObjA$ scoreboard objectives add
DEFINE $ObjR$ scoreboard objectives remove
DEFINE $TeamA$ scoreboard teams add
DEFINE $TeamO$ scoreboard teams option
DEFINE $TeamR$ scoreboard teams remove
DEFINE $TextStart$ {"text":"","extra":[{"text":"[","color":"gray"},{"text":"PARSE($TD$)","color":"PARSE($Color$)","bold":"true","hoverEvent":{"action":"show_text","value":{"text":"PARSE($TDName$)","color":"PARSE($Color$)"}}},{"text":"]","color":"gray"},{"text":": "},
DEFINE $SPpvp$ 1
DEFINE $SPsat$ 1
DEFINE Deactivate fill |0| stonebrick 0
DEFINE Activate fill |0| redstone_block 0
DEFINE ColorFillWool fill |0| wool |1|
DEFINE ColorFillClay fill |0| stained_hardened_clay |1|
DEFINE ColorFillGlass fill |0| stained_glass |1|
DEFINE ColorFillWood fill |0| planks |1|
DEFINE ScTG scoreboard players tag
DEFINE ScOP scoreboard players operation
DEFINE ScTE scoreboard players test
DEFINE ScRE scoreboard players reset
DEFINE ScTJ scoreboard teams join
DEFINE ScTL scoreboard teams leave
DEFINE RevST scoreboard players tag @a[|0|] remove |0|
DEFINE SetblockTestfor setblock ~ ~ ~ repeating_command_block 11 replace {TrackOutput:0b,auto:1b}
DEFINE ExecuteSpawnStand @e[type=ArmorStand,SpawnStand,SPgam=0]
DEFINE FinalSpawnStand @e[type=ArmorStand,SpawnStand,SPgam=0] SPgam = PARSE($SPid$)
DEFINE NumberAdd |0| Number = |0|
DEFINE NumberObjAdd Number dummy
FUNC Func_CMDSave
fill 0x -1y 0z 3x -3y 3z air 0
setblock 1x -1y 1z structure_block 0 replace {name:"CMDSave_$CMDName$",mode:"SAVE",posX:0,posY:2,posZ:0,sizeX:$CMDSizeX$,sizeY:$CMDSizeY$,sizeZ:$CMDSizeZ$}
setblock 1x -3y 1z structure_block 0 replace {name:"CMDSave_$CMDName$",mode:"LOAD",posX:0,posY:4,posZ:0}
setblock 1x -1y 0z wooden_button 4
setblock 1x -3y 0z wooden_button 4
setblock 2x -1y 1z redstone_lamp 0
setblock 2x -3y 1z redstone_lamp 0
setblock 1x -1y 2z minecraft:command_block 3 replace {TrackOutput:0b,Command:"setblock ~1 ~ ~ redstone_block 0"}
END
FUNC Func_SpawnIDSetting
@a[$SA$] SPid + 0
@a[$SA$,SPid<-$SPid$] SPid = $SPid$
@a[$SA$,SPid>-$SPid$] SPid = $SPid$
END
FUNC Func_SpawnStandStart
@e[type=ArmorStand,SpawnStand] SPtp = $SPid$
@e[type=ArmorStand,SpawnStand] SPpvp = $SPpvp$
@e[type=ArmorStand,SpawnStand] SPsat = $SPsat$
@e[type=ArmorStand,SpawnStand] SPgmd = 1
@e[type=ArmorStand,SpawnStand,SPgam>=1] SPgac = 1
END
FUNC Func_SpawnStandEnd
@e[type=ArmorStand,SpawnStand] SPtp = 0
@e[type=ArmorStand,SpawnStand] SPpvp = 0
@e[type=ArmorStand,SpawnStand] SPsat = 1
@e[type=ArmorStand,SpawnStand] SPgmd = 1
@e[type=ArmorStand,SpawnStand,SPgam=$SPid$] SPgam = 0
@e[type=ArmorStand,SpawnStand] SPwea = 0
END
FUNC Func_SpawnStandEdit
@e[type=ArmorStand,SpawnStand] SPtp = |0|
@e[type=ArmorStand,SpawnStand] SPpvp = |1|
@e[type=ArmorStand,SpawnStand] SPsat = |2|
@e[type=ArmorStand,SpawnStand] SPgmd = |3|
@e[type=ArmorStand,SpawnStand,SPgam>=1] SPgac = 1
@e[type=ArmorStand,SpawnStand] SPwea = |4|
END
//>
//<Main Start
FUNC Func_EditGeneralScoreboardStart
///	Scoreboards
USE $ObjA$
$Name$RaceCP dummy $Name$ Race Checkpoint
$Name$RaceTI dummy $Name$ Race Timer
$Name$RaceAR dummy $Name$ Race Arrow
$Name$RaceTP dummy $Name$ Race Teleport
UNUSE
ExecuteSpawnStand summon AreaEffectCloud $Dispenser$ {Duration:1000000,Tags:["$Name$RaceTI"]}
@e[type=AreaEffectCloud,$Name$RaceTI] $Name$RaceAR = 0
@e[type=AreaEffectCloud,$Name$RaceTI] $Name$RaceTP = 0
///	Other
gamerule naturalRegeneration false
END
//>
//<Main Clock
FUNC Func_EditGeneralScoreboardClock
$s$kill @e[$SA$,type=Item]
///	Iron bars
LOOP 1 3 + 1
@a[$Win|0|S$,c=1,m=2,$Name$RaceBC=|0|] fill $WinIron|0|B$ iron_bars 0
END
///	Random beginning obsidian
@e[AreaEffectCloud,$Name$RaceTI] $Name$RaceTI + 1
@e[AreaEffectCloud,$Name$RaceTI,$Name$RaceTI=95] fill $FillStructure$ air 9
@e[AreaEffectCloud,$Name$RaceTI,$Name$RaceTI=95] setblock $RBlock$ redstone_block 0
@e[AreaEffectCloud,$Name$RaceTI,$Name$RaceTI=95] setblock $RBlock$ air 0
@e[AreaEffectCloud,$Name$RaceTI,$Name$RaceTI=100] clone $FillStructure$ $ObsidianLoad$
@e[AreaEffectCloud,$Name$RaceTI,$Name$RaceTI=100] $Name$RaceTI = 0
///	Blindness in beginning area
///	effect @a[$Blindness$,m=2,team=$Name$R] 15 2 0 true
///	Dispensers
@e[type=AreaEffectCloud,$Name$RaceTI,$Name$RaceTP=0] summon Arrow ~ ~ ~ {damage:1,Fire:600s,pickup:0b,life:1190s,Motion:[0d,0d,1.5d]}
@e[type=AreaEffectCloud,$Name$RaceTI,$Name$RaceTP=0] particle flame ~ ~ ~ 0.3 0.3 0.3 0.01 5 force
@e[type=AreaEffectCloud,$Name$RaceTI,$Name$RaceTP=0] playsound minecraft:entity.arrow.shoot voice @a ~ ~ ~ 0.5
@e[type=AreaEffectCloud,$Name$RaceTI,$Name$RaceTP>=0<=2] $Name$RaceTP + 1
@e[type=AreaEffectCloud,$Name$RaceTI,$Name$RaceTP=2] $Name$RaceAR + 1
$s$tp @e[type=AreaEffectCloud,$Name$RaceTI,$Name$RaceTP=2,$Name$RaceAR>=0<=10] ~1 ~ ~
$s$tp @e[type=AreaEffectCloud,$Name$RaceTI,$Name$RaceTP=2,$Name$RaceAR=11] $Dispenser$
@e[type=AreaEffectCloud,$Name$RaceTI,$Name$RaceTP=2,$Name$RaceAR=11] $Name$RaceAR = 0
@e[type=AreaEffectCloud,$Name$RaceTI,$Name$RaceTP=2] $Name$RaceTP = 0
///	Regeneration timer
effect @a[$SA$,m=2,team=$Name$R] 10 0 10 true
@a[$SA$,m=2,team=$Name$R] $Name$RaceTI + 1 
effect @a[$SA$,m=2,team=$Name$R,$Name$RaceTI=120] 10 1 10 true
@a[$SA$,m=2,team=$Name$R,$Name$RaceTI=120] $Name$RaceTI = 0
effect @a[$SP$,m=2,team=$Name$R] 10 1 10 true
///	Golden Apple
replaceitem entity @a[$SA$,m=2,team=$Name$R,$Name$RaceDE>=1] slot.weapon.offhand CCItem_Potion
///	Checkpoint
@a[$SA$,m=2,team=$Name$R] $Name$RaceCP + 0
@a[$Checkpoint$,m=2,team=$Name$R,$Name$RaceCP=0] tellraw @a $TextStart${"selector":"@a[c=1,r=0,m=2,team=$Name$R,$Name$RaceCP=0]"},{"text":" has reached checkpoint 1!","color":"yellow"}]}
@a[$Checkpoint$,m=2,team=$Name$R,$Name$RaceCP=0] playsound minecraft:entity.player.levelup voice @a[c=1]
@a[$Checkpoint$,m=2,team=$Name$R,$Name$RaceCP=0] $Name$RaceCP = 1
$s$tp @a[$SP$,m=2,team=$Name$R,$Name$RaceCP=1] $CheckpointTP$
END
//>
//<Countdown Clock
FUNC Func_EditCountdownClock
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=120] fill $Dao$ stonebrick 0 replace redstone_block 0
///	@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=120] fill $Dro$ redstone_block 0 replace stonebrick 0
END
//>
//<Main End
FUNC Func_EditGeneralScoreboardEnd
///	Scoreboard
USE $ObjR$
$Name$RaceCP
$Name$RaceTI
$Name$RaceAR
$Name$RaceTP
UNUSE
///	Countdown reset
$s$kill @e[type=AreaEffectCloud,$Name$RaceTI]
///	General reset
fill $IronBarReset$ air 0 replace iron_bars 0
gamerule naturalRegeneration true
fill $Dao$ redstone_block 0 replace stonebrick 0
///	fill $Dro$ stonebrick 0 replace redstone_block 0
END
//<Main Start
FUNC Func_GeneralScoreboardStart
///	Scoreboards
USE $ObjA$
$Name$Race dummy $TDName$
$Name$RaceCD dummy $TDName$ Countdown
$Name$RaceCL dummy $TDName$ Clear
$Name$RaceDE deathCount $TDName$ Deaths
$Name$RaceBC dummy $TDName$ Broadcast
UNUSE
ExecuteSpawnStand scoreboard objectives setdisplay sidebar $Name$Race
scoreboard teams add $Name$R
scoreboard teams option $Name$R color $Color$
scoreboard teams option $Name$R seeFriendlyInvisibles true
scoreboard teams option $Name$R collisionRule never
scoreboard teams option $Name$R friendlyfire false
///	Countdown start
ExecuteSpawnStand summon AreaEffectCloud ~ ~ ~ {Duration:130,Tags:["$Name$RaceCD"]}
///	Other
\/spawn $Name$Race = 0
ScTJ $Name$R /spawn
END
//>
//<Main Clock
FUNC Func_GeneralScoreboardClock
Func_SpawnIDSetting
$s$kill @e[$SA$,type=Item]
@a[$SA$,team=!$Name$R] $Name$RaceBC + 0
@a[$SA$,m=2] $Name$RaceCL + 0
@a[$SA$,m=2,$Name$RaceCL=0] $Name$RaceDE = 1
@a[$SA$,m=2,$Name$RaceCL=0] $Name$RaceCL = 1
effect @a[$SA$,m=2,$Name$RaceDE>=1] clear
$s$clear @a[$SA$,m=2,$Name$RaceDE>=1]
ScTJ $Name$R @a[$SA$,team=!$Name$R]
effect @a[$SA$,m=2,team=$Name$R] 14 3 0 true
LOOP 1 3 + 1
@a[$Win|0|S$,c=1,m=2,$Name$RaceBC=0] $Name$RaceBC = |0|
@a[$Win|0|S$,c=1,m=2,$Name$RaceBC=|0|] tellraw @a[$SA$] $TextStart${"selector":"@a[c=1,m=2]"},{"text":" $Win|0|M$","color":"green"}]}
@a[$Win|0|S$,c=1,m=2,$Name$RaceBC=|0|] playsound minecraft:entity.player.levelup voice @a
@a[$Win|0|S$,c=1,m=2,$Name$RaceBC=|0|] fill $Win|0|F$ $Win|0|B$ 0
END
@a[$SA$,m=2,$Name$RaceBC>=1] ScOP @a[r=1,c=1,m=2,$Name$RaceBC>=1] $Name$Race = @a[r=1,c=1,m=2,$Name$RaceBC>=1] $Name$RaceBC
Func_EditGeneralScoreboardClock
@a[$SA$,m=2,$Name$RaceDE>=1] $Name$RaceDE = 0
ScOP @a[$SA$,m=2,$Name$RaceBC>=1] $Name$Race *= -1 Number
ScOP @a[$SA$,m=2,$Name$RaceBC>=1] $Name$RaceBC *= -1 Number
END
//>
//<Countdown
FUNC Func_CountdownClock
@e[type=AreaEffectCloud,$Name$RaceCD] $Name$RaceCD + 1
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=20] tellraw @a[$SA$] $TextStart${"text":"5","color":"yellow","bold":"true"}]}
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=20] @a[$SA$] playsound block.note.pling voice @a[c=1] ~ ~ ~ 0.5
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=40] tellraw @a[$SA$] $TextStart${"text":"4","color":"yellow","bold":"true"}]}
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=40] @a[$SA$] playsound block.note.pling voice @a[c=1] ~ ~ ~ 1
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=60] tellraw @a[$SA$] $TextStart${"text":"3","color":"yellow","bold":"true"}]}
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=60] @a[$SA$] playsound block.note.pling voice @a[c=1] ~ ~ ~ 1.5
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=80] tellraw @a[$SA$] $TextStart${"text":"2","color":"yellow","bold":"true"}]}
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=80] @a[$SA$] playsound block.note.pling voice @a[c=1] ~ ~ ~ 2
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=100] tellraw @a[$SA$] $TextStart${"text":"1","color":"yellow","bold":"true"}]}
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=100] @a[$SA$] playsound block.note.pling voice @a[c=1] ~ ~ ~ 2
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=120] @a[$SA$] playsound minecraft:entity.wither.death voice @a[c=1]
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=120] tellraw @a[$SA$] $TextStart${"text":"GO!","color":"green","bold":"true"}]}
@e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=120] title @a[$SA$] title {"text":"GO!","color":"green"}
testfor @e[type=AreaEffectCloud,$Name$RaceCD,$Name$RaceCD=120]
CONDITION
Deactivate(CBPCountdown)
END
//>
//<Main End
FUNC Func_GeneralScoreboardEnd
///	Scoreboard
USE $ObjR$
$Name$Race
$Name$RaceCD
$Name$RaceCL
$Name$RaceDE
$Name$RaceBC
UNUSE
scoreboard teams remove $Name$R
///	Countdown reset
$s$kill @e[type=AreaEffectCloud,$Name$RaceCD]
///	General reset
LOOP 1 3 + 1
fill $Win|0|F$ air 0
END
effect @a[$SA$,m=2] clear
$s$clear @a[$SA$,m=2]
effect @a[$SA$,m=2] 6 20 100 true
@a[$SA$,m=2] SPtp = $SPid$
END
//>
//<Groups
Func_CMDSave
:CBPMainStart PULSE $Style$
Func_SpawnStandStart
Deactivate(CBPMainStart)
Func_GeneralScoreboardStart
Func_EditGeneralScoreboardStart
Activate(CBPMainClock)
Activate(CBPCountdown)
FinalSpawnStand
:CBPMainClock CLOCK $Style$
Func_GeneralScoreboardClock
:CBPCountdown CLOCK $Style$
Func_CountdownClock
Func_EditCountdownClock
:CBPMainEnd PULSE $Style$
Func_SpawnStandEnd
Deactivate(CBPMainEnd)
Func_GeneralScoreboardEnd
Func_EditGeneralScoreboardEnd
Deactivate(CBPMainClock)
Deactivate(CBPCountdown)
//>
//>
